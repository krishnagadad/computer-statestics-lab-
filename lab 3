'''' 3: Program on Time series: GroupBy Mechanics to display in data vector,
 multivariate time series and forecasting formats '''


import pandas as pd
import numpy as np
from sklearn.linear_model import LinearRegression

# Create simple time series data
data = {
    'Date': pd.date_range(start='2024-01-01', periods=6, freq='M'),
    'Sales': [100, 120, 140, 160, 180, 200],
    'Temperature': [25, 26, 28, 30, 32, 33]
}

df = pd.DataFrame(data)
print("=== Original Time Series Data ===")
print(df)

# GroupBy Mechanics: Group by Month (for example)
df['Month'] = df['Date'].dt.month
grouped = df.groupby('Month')['Sales'].sum()
print("\n=== GroupBy: Total Sales per Month ===")
print(grouped)

# Data Vector (Univariate Time Series)
sales_vector = df['Sales'].values
print("\n=== Data Vector (Sales Only) ===")
print(sales_vector)

# Multivariate Time Series (Sales + Temperature)
multi_vector = df[['Sales', 'Temperature']].values
print("\n=== Multivariate Time Series (Sales & Temperature) ===")
print(multi_vector)

# Simple Forecasting using Linear Regression
df['Time'] = np.arange(len(df))
X = df[['Time']]
y = df['Sales']

model = LinearRegression()
model.fit(X, y)

#Predict next 3 months
future_time = np.arange(len(df), len(df) + 3)
forecast = model.predict(future_time.reshape(-1, 1))

print("\n=== Forecasted Sales for Next 3 Months ===")
print(forecast)
